<ion-view>
  <ion-nav-title>
      Returns for {{order.ShipToContact.Name}}
  </ion-nav-title>
  <ion-content>
    <ion-refresher pulling-text="Pull to refresh..." on-refresh="getReturns(true)"></ion-refresher>
    <div ng-if="order">
        <div>
          <div class="middle-box text-center" ng-if="!returns || returns.length == 0">
            <i class="icon ion-ios-undo"></i>
            <h3 class="font-bold m-t-md padding">No items have been collected for return. Use the action button to scan an item or enter it&#39;s barcode</h3>
          </div>

          <ion-list ng-repeat="(key, value) in returns | groupBy: 'Order_Store__r.Store__r.Name'">
            <div class="item item-divider">
              {{key}}
            </div>

            <a class="item item-thumbnail-left" ui-sref="app.productdetails({productId : item.PricebookEntry.Product2.Parent_Product__c})" ng-repeat="item in value">
                <img ng-src="{{item.PricebookEntry.Product2.Image__r.Image_Source__c}}" fallback-src="{{item.PricebookEntry.Product2.Parent_Product__r.Image__r.Image_Source__c}}">
                <h3>{{item.PricebookEntry.Product2.Root_Product_Name__c}}</h3>
                <p>{{item.PricebookEntry.Product2.Name}}</p>
                <p>{{item.PricebookEntry.Product2.SKU__c}}</p>
              </a>
          </ion-list>
        </div>

    </div>

  </ion-content>
  <nav mfb-menu position="br" ng-class="isIOS ? 'ab-margin' : ''" effect="zoomin" active-icon="ion-close-round" resting-icon="ion-plus-round" toggling-method="click" menu-state="order.returnStatus">
    <button mfb-button icon="ion-qr-scanner" label="Scan Item" ng-click="scanItem()"></button>
    <button mfb-button icon="ion-edit" label="Manual Entry" ng-click="enterItem()"></button>
    <button mfb-button icon="ion-ios-flag" label="Finish Returns" ng-click="finishReturns()"></button>
  </nav>
</ion-view>
