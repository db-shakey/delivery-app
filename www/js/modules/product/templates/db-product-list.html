<ion-view class="product-list">
  <ion-nav-title >
    {{productList[0].Store__r.Name}} Products
  </ion-nav-title>
  <ion-nav-buttons side="right">
    <button class="button button-icon button-clear ion-ios-search-strong m-r-sm" ng-click="showFilterBar()" ng-if="productList && productList.length > 0"></button>
  </ion-nav-buttons>
  <ion-content>
    <ion-refresher pulling-text="Pull to refresh..." on-refresh="searchProducts(searchString, limit)"></ion-refresher>
    <ion-list ng-repeat="(key, value) in productList | groupBy: 'Family'" class="m-b-xl" ng-if="productList && productList.length > 0">
        <ion-item class="item-divider">
          {{key}}
        </ion-item>
        <ion-item ng-repeat="product in value" class="item-thumbnail-left" ng-click="goToProduct(product)">
          <img lazy-img="{{product.Image__r.Image_Source__c}}" fallback-src>
          <h2>
            {{product.Name}}

          </h2>
          <p class="m-t-xs">{{product.Brand__c}}</p>
          <p class="text-muted m-t-xs" ng-if="product.Variants__r">
            {{product.Variants__r.totalSize}} variants
          </p>
        </ion-item>
    </ion-list>
    <div class="middle-box text-center" ng-if="productList.length == 0">
      <i class="icon ion-android-cancel"></i>
      <h3 class="font-bold">No products to display.</h3>
    </div>
    <div class="middle-box text-center loading" ng-if="!productList">
      <ion-spinner></ion-spinner>
      <h3 class="font-bold">Loading Products</h3>
    </div>
    <ion-infinite-scroll on-infinite="searchProducts(searchText, limit + 10)" distance="1%" ng-if="hasMore"></ion-infinite-scroll>
  </ion-content>

  <nav mfb-menu position="br" effect="zoomin"
       active-icon="ion-plus" resting-icon="ion-plus" ui-sref="db.newProduct({storeId : storeId})">
  </nav>

</ion-view>


<!--

-->
